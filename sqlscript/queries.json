{
	"name": "queries",
	"properties": {
		"content": {
			"query": "--Query 1: \nselect top 100 ca_zip \n       ,sum(cs_sales_price) \n from catalog_sales \n     ,customer \n     ,customer_address \n     ,date_dim \n where cs_bill_customer_sk = c_customer_sk \n \tand c_current_addr_sk = ca_address_sk  \n \tand ( substring(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', \n                                   '85392', '85460', '80348', '81792') \n \t      or ca_state in ('CA','WA','GA') \n \t      or cs_sales_price > 500) \n \tand cs_sold_date_sk = d_date_sk \n \tand d_qoy = 2 and d_year = 1999 \n group by ca_zip \n order by ca_zip;\n--Query 2: \nselect top 100  \n   count(distinct cs_order_number) as \"order count\" \n  ,sum(cs_ext_ship_cost) as \"total shipping cost\" \n  ,sum(cs_net_profit) as \"total net profit\" \nfrom \n   catalog_sales cs1 \n  ,date_dim \n  ,customer_address \n  ,call_center \nwhere \n    d_date between '1999-3-01' and  \n\t\t   dateadd(day, 60, cast('1999-3-01' as date)) \nand cs1.cs_ship_date_sk = d_date_sk \nand cs1.cs_ship_addr_sk = ca_address_sk \nand ca_state = 'TX' \nand cs1.cs_call_center_sk = cc_call_center_sk \nand cc_county in ('Jefferson Davis Parish','Gage County','Sierra County','Pennington County', \n                  'Wadena County' \n) \nand exists (select * \n            from catalog_sales cs2 \n            where cs1.cs_order_number = cs2.cs_order_number \n              and cs1.cs_warehouse_sk <> cs2.cs_warehouse_sk) \nand not exists(select * \n               from catalog_returns cr1 \n               where cs1.cs_order_number = cr1.cr_order_number) \norder by count(distinct cs_order_number);\n--Query 3: \nselect top 100 i_item_id, \n        ca_country, \n        ca_state,  \n        ca_county, \n        avg( cast(cs_quantity as decimal(12,2))) agg1, \n        avg( cast(cs_list_price as decimal(12,2))) agg2, \n        avg( cast(cs_coupon_amt as decimal(12,2))) agg3, \n        avg( cast(cs_sales_price as decimal(12,2))) agg4, \n        avg( cast(cs_net_profit as decimal(12,2))) agg5, \n        avg( cast(c_birth_year as decimal(12,2))) agg6, \n        avg( cast(cd1.cd_dep_count as decimal(12,2))) agg7 \n from catalog_sales, customer_demographics cd1,  \n      customer_demographics cd2, customer, customer_address, date_dim, item \n where cs_sold_date_sk = d_date_sk and \n       cs_item_sk = i_item_sk and \n       cs_bill_cdemo_sk = cd1.cd_demo_sk and \n       cs_bill_customer_sk = c_customer_sk and \n       cd1.cd_gender = 'M' and  \n       cd1.cd_education_status = 'College' and \n       c_current_cdemo_sk = cd2.cd_demo_sk and \n       c_current_addr_sk = ca_address_sk and \n       c_birth_month in (5,8,7,12,11,3) and \n       d_year = 2000 and \n       ca_state in ('LA','OH','TN' \n                   ,'MO','GA','MI','MS') \n group by rollup (i_item_id, ca_country, ca_state, ca_county) \n order by ca_country, \n        ca_state,  \n        ca_county, \n\ti_item_id; \n \n--Query 4: \nselect top 100 i_item_id \n       ,i_item_desc  \n       ,i_category  \n       ,i_class  \n       ,i_current_price \n       ,sum(cs_ext_sales_price) as itemrevenue  \n       ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over \n           (partition by i_class) as revenueratio \n from\tcatalog_sales \n     ,item  \n     ,date_dim \n where cs_item_sk = i_item_sk  \n   and i_category in ('Books', 'Jewelry', 'Home') \n   and cs_sold_date_sk = d_date_sk \n and d_date between cast('1999-01-08' as date)  \n\t\t\t\t\tand dateadd(day, 30, cast('1999-01-08' as date)) \n group by i_item_id \n         ,i_item_desc  \n         ,i_category \n         ,i_class \n         ,i_current_price \n order by i_category \n         ,i_class \n         ,i_item_id \n         ,i_item_desc \n         ,revenueratio; \n \n \n--Query 5: \nselect top 100 i_item_id,  \n        avg(cs_quantity) agg1, \n        avg(cs_list_price) agg2, \n        avg(cs_coupon_amt) agg3, \n        avg(cs_sales_price) agg4  \n from catalog_sales, customer_demographics, date_dim, item, promotion \n where cs_sold_date_sk = d_date_sk and \n       cs_item_sk = i_item_sk and \n       cs_bill_cdemo_sk = cd_demo_sk and \n       cs_promo_sk = p_promo_sk and \n       cd_gender = 'F' and  \n       cd_marital_status = 'M' and \n       cd_education_status = 'Secondary' and \n       (p_channel_email = 'N' or p_channel_event = 'N') and \n       d_year = 2000  \n group by i_item_id \n order by i_item_id; \n \n \n--Query 6: \nselect top 100 sum(cs_ext_discount_amt)  as \"excess discount amount\"  \nfrom  \n   catalog_sales  \n   ,item  \n   ,date_dim \nwhere \ni_manufact_id = 750 \nand i_item_sk = cs_item_sk  \nand d_date between '2001-01-17'   \n\t\tand dateadd(day, 90, cast('2001-01-17' as date)) \nand d_date_sk = cs_sold_date_sk  \nand cs_ext_discount_amt   \n     > (  \n         select  \n            1.3 * avg(cs_ext_discount_amt)  \n         from  \n            catalog_sales  \n           ,date_dim \n         where  \n              cs_item_sk = i_item_sk  \n          and d_date between '2001-01-17' and \n                              dateadd(day, 90, cast('2001-01-17' as date)) \n          and d_date_sk = cs_sold_date_sk  \n      ) \n",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "insider",
				"poolName": "Built-in"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}